---
title: "Introduction to the use of fisflix"
author: "Nina Schiettekatte"
output:
  pdf_document:
    citation_package: natbib
    fig_caption: yes
    keep_tex: yes
    latex_engine: pdflatex
  html_document:
    fig_caption: yes
header-includes:
- \usepackage{graphicx}
- \usepackage{float}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


<img src="man/figures/fishflux.png" width = 120 alt="fishflux logo"/> 

## Introduction

The `fishflux` package provides a tool to model fluxes of C (carbon), N (nitrogen) and P (phosphorus) in fish. It combines basic priciples from elemental stoichiometry and metabolic theory. The package offers a userfriendly interface to make nutrient dynamic modelling available for anyone. `fishflux` is mostly targeted towards fish ecologists, wishing to predict nutrient ingestion, egestion and excretion to study fluxes of nutrients and energy. 

Main assets:

* Provides functions to model fluxes of Carbon, Nitrogen and Phosphorus for fish with or without the MCMC sampler provided by stan.
* Provides some tools to find the right parameters as inputs into the model
* Provides a plotting function to illustrate results

## Installing and loading fishflux

`fishflux` uses Markov Chain Monte Carlo simulations provided by [stan](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started). Therefore, the first step is to install [stan](https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started).

### GitHub

The best way to install the latest development version of `fishflux` is to instal it from GitHub. 

```r
install.packages("devtools")
devtools::install_github("nschiett/fishflux", dependencies=TRUE)
library(fishflux)
```
### CRAN

`fishflux` will be available on CRAN in the future:

```r
install.packages("fishflux")
library(fishflux)
```

### Downloaded package file

Another option is to download the source file available on github [here](https://github.com/nschiett/fishflux).

```r
install.packages(path_to_fishflux_file, repos = NULL, type="source")
library(fishflux)
```

### How to use fishflux?

`fishflux` is designed to follow three simple steps:
1. Find the right input parameters
2. Run the model simulation with those input parameters
3. Plot the model results

#### Find parameters

Below a table showing all parameters needed to run the mosel simulation. `fishflux` provides functions to find some of these parameters, but note that others have to be provided by the user at this stage. 

```{r,message=FALSE,echo=FALSE,results='asis'}
knitr::kable(data.frame(
  test1 = c("a","b"),test2 = c("expla", "explb")
),col.names = c("species","$L_{inf}$"),caption = "Species specific parameters. $L_{inf}$ and k are parameters of the Von Beffalanty growth curve. Fp, Fn and Fc are the element contents of the fish's diet. k is a parameter defining the activity level of the fish")
```

A good place to start is to check if you are using the correct scientific name of your fish of interest. The function `name_errors` will tell you if the species name is correct. This function can be useful, especially when working with larger databases.  

```{r,message=TRUE,echo=TRUE}
fishflux::name_errors("Zebrazoma scopas")
```

When we have verified or corrected the species name we can start finding some parameters. 

The `find_lw` function searches fishbase to find length-weight relationship parameters `lw_a` and `lw_b` obtained from *Froese, R., J. Thorson and R.B. Reyes Jr., 2013. A Bayesian approach for estimating length-weight relationships in fishes. J. Appl. Ichthyol. (2013):1-7.* 

```{r,message=TRUE,echo=TRUE}
fishflux::find_lw("Zebrasoma scopas")
```

`growth_params()`, `trophic_level()` and ``





